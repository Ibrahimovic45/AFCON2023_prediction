# -*- coding: utf-8 -*-
"""model_GB.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_WUgVCi78Dsnr7JH2gguWvmZtbnLQ3Ad
"""

#GB model
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from sklearn.model_selection import train_test_split, GridSearchCV
import numpy as np
import pandas as pd

def gb():
  model_db = pd.read_csv("database.csv")
  X = model_db.iloc[:, 3:]
  y = model_db[["target"]]

  X_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.2, random_state=1)
  gb = GradientBoostingClassifier(random_state=5)

  params = {"learning_rate": [0.01, 0.1, 0.5],
              "min_samples_split": [5, 10],
              "min_samples_leaf": [3, 5],
              "max_depth":[3,5,10],
              "max_features":["sqrt"],
              "n_estimators":[100, 200]
          }

  gb_cv = GridSearchCV(gb, params, cv = 3, n_jobs = -1, verbose = False)

  gb_cv.fit(X_train.values, np.ravel(y_train))
  gb = gb_cv.best_estimator_
  return gb